{% extends 'layout.html' %}


{% block link %}
  <script src="../static/js/index.js"></script>
  <script src="../static/js/localStorage.js"></script>
  <link rel="stylesheet" href="../static/css/chat.css">

{%endblock%}
{%block title%}
    chat app
{% endblock %}

{% block body %}   

<div class="row">
      
    <!--SIDEBAR-->

  
    <div class="col-md-3 hashtag bg-black bs-sidebar">
      
        <h3 class="sidebar-head"> <strong>#Channels</strong>
        <button class="channel-btn btn" type="button" data-toggle="modal" data-target="#channelCreation" aria-expanded="false" aria-controls="collapseExample">
              <i class="fas fa-plu"></i></button>
        </h3>
        

        <!--  MODAL FOR NEW CHANNEL CREATION -->

        <div class="modal fade" id="channelCreation" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Create New Channel</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">

                <form id="CreateNewChannel" onsubmit="createNewChannelFunction()" class="text-dark  justify-content-center">
                   <!-- Channel_Name -->
                   <div class="form-group">
                    <label for="channel_name" class="text-dark">Channel Name</label>
                    <input type="text" id="channel_name" class="form-control" placeholder="#Channel_Name" autocomplete="off" required>
                    <small class="text-red channelInvalidInput font-weight-bold text-danger"></small><hr/>
                    <small class="form-text text-muted">Your channel name must starts with <strong>#</strong> and should be 6-20 characters long containing letters and numbers, and must not contain spaces, special characters or emoji.</small>
                  </div>  
                  
                  <hr/>
                  <div class="form-group">
                    <button type="submit" class="btn btn-outline-success form-control">Submit</button>
                  </div>                  
                </form>
              </div>
              
            </div>
          </div>
        </div>
 


        <!--  -->
        <div class="sidebar-ulist">
        <ul class="list-group" id="ulist">
            <!-- <a onclick="chatboxheader();" href="#"> <div class="list-group-item  sidebar-list"># Porta ac consectetur ac </div>  </a>
            <a onclick="chatboxheader();" href="#"> <div class="list-group-item  sidebar-list"># Vestibulum at eros      </div>  </a>
            <a onclick="chatboxheader();" href="#"> <div class="list-group-item  sidebar-list"># Cras justo odio         </div>  </a>
            <a onclick="chatboxheader();" href="#"> <div class="list-group-item  sidebar-list"># Dapibus ac facilisis in </div>  </a>
            <a onclick="chatboxheader();" href="#"> <div class="list-group-item  sidebar-list"># Morbi leo risus         </div>  </a>
            <a onclick="chatboxheader();" href="#"> <div class="list-group-item  sidebar-list"># Porta ac consectetur ac </div>  </a>
            <a onclick="chatboxheader();" href="#"> <div class="list-group-item  sidebar-list"># Vestibulum at eros      </div>  </a> --> 
        </ul>

        </div>
    </div>

    <!-- SIDEBAR ENDS -->


    <!--MAIN BODY STARTS-->

    <div class="col-md-9 main container-fluid">
        
        <div class="head">

          <!-- <h3 class="head-h3">Message Box</h3> -->
          <h3 class="head-h3">#Flack Channel</h3>

        </div>


        <div class="body">


            <div class="user1 shadow-sm rounded">
                <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
                <hr/>
                <div  id="user">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia voluptatum corporis saepe beatae, rem vel est quaerat recusandae culpa dignissimos voluptates reiciendis hic nostrum deleniti minima eaque magnam, ipsa incidunt porro veritatis odio consequatur? Nemo, sequi necessitatibus, culpa earum harum expedita consectetur recusandae eum ratione tempora ullam a vitae quis.</div>
              </div>
              
         <div class="user2 shadow-sm  rounded">
            <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
            <hr/>
           <div>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Obcaecati voluptatibus doloremque sed a dolor veniam sapiente blanditiis quibusdam, nihil sequi.</div>
         </div>
              
         <div class="user1 shadow-sm  rounded">
                <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
                <hr/>
                <div  id="user">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia voluptatum corporis saepe beatae, rem vel est quaerat recusandae culpa dignissimos voluptates reiciendis hic nostrum deleniti minima eaque magnam, ipsa incidunt porro veritatis odio consequatur? Nemo, sequi necessitatibus, culpa earum harum expedita consectetur recusandae eum ratione tempora ullam a vitae quis.</div>
              </div>
              
         <div class="user2 shadow-sm  rounded">
            <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
            <hr/>
           <div>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Obcaecati voluptatibus doloremque sed a dolor veniam sapiente blanditiis quibusdam, nihil sequi.</div>
         </div>



         <div class="user1 shadow-sm  rounded">
          <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
          <hr/>
          <div  id="user">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia voluptatum corporis saepe beatae, rem vel est quaerat recusandae culpa dignissimos voluptates reiciendis hic nostrum deleniti minima eaque magnam, ipsa incidunt porro veritatis odio consequatur? Nemo, sequi necessitatibus, culpa earum harum expedita consectetur recusandae eum ratione tempora ullam a vitae quis.</div>
        </div>
        
       <div class="user2 shadow-sm   rounded">
          <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
          <hr/>
         <div>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Obcaecati voluptatibus doloremque sed a dolor veniam sapiente blanditiis quibusdam, nihil sequi.</div>
       </div>
     
     
     
       <div class="user1 shadow-sm  rounded">
        <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
        <hr/>
        <div  id="user">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia voluptatum corporis saepe beatae, rem vel est quaerat recusandae culpa dignissimos voluptates reiciendis hic nostrum deleniti minima eaque magnam, ipsa incidunt porro veritatis odio consequatur? Nemo, sequi necessitatibus, culpa earum harum expedita consectetur recusandae eum ratione tempora ullam a vitae quis.</div>
      </div>

      <div class="user2 shadow-sm   rounded">
      <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
      <hr/>
      <div>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Obcaecati voluptatibus doloremque sed a dolor veniam sapiente blanditiis quibusdam, nihil sequi.</div>
      </div>          




    <div class="user1 shadow-sm  rounded">
      <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
      <hr/>
      <div  id="user">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia voluptatum corporis saepe beatae, rem vel est quaerat recusandae culpa dignissimos voluptates reiciendis hic nostrum deleniti minima eaque magnam, ipsa incidunt porro veritatis odio consequatur? Nemo, sequi necessitatibus, culpa earum harum expedita consectetur recusandae eum ratione tempora ullam a vitae quis.</div>
    </div>
    
    <div class="user2 shadow-sm   rounded">
    <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
    <hr/>
    <div>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Obcaecati voluptatibus doloremque sed a dolor veniam sapiente blanditiis quibusdam, nihil sequi.</div>
    </div>



    <div class="user1 shadow-sm  rounded">
      <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
      <hr/>
      <div  id="user">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia voluptatum corporis saepe beatae, rem vel est quaerat recusandae culpa dignissimos voluptates reiciendis hic nostrum deleniti minima eaque magnam, ipsa incidunt porro veritatis odio consequatur? Nemo, sequi necessitatibus, culpa earum harum expedita consectetur recusandae eum ratione tempora ullam a vitae quis.</div>
    </div>

    <div class="user2 shadow-sm   rounded">
    <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
    <hr/>
    <div>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Obcaecati voluptatibus doloremque sed a dolor veniam sapiente blanditiis quibusdam, nihil sequi.</div>
    </div>



    <div class="user1 shadow-sm  rounded">
      <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
      <hr/>
      <div  id="user">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia voluptatum corporis saepe beatae, rem vel est quaerat recusandae culpa dignissimos voluptates reiciendis hic nostrum deleniti minima eaque magnam, ipsa incidunt porro veritatis odio consequatur? Nemo, sequi necessitatibus, culpa earum harum expedita consectetur recusandae eum ratione tempora ullam a vitae quis.</div>
    </div>

    <div class="user2 shadow-sm   rounded">
    <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
    <hr/>
    <div>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Obcaecati voluptatibus doloremque sed a dolor veniam sapiente blanditiis quibusdam, nihil sequi.</div>
    </div>



      <div class="user1 shadow-sm  rounded">
        <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
        <hr/>
        <div  id="user">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia voluptatum corporis saepe beatae, rem vel est quaerat recusandae culpa dignissimos voluptates reiciendis hic nostrum deleniti minima eaque magnam, ipsa incidunt porro veritatis odio consequatur? Nemo, sequi necessitatibus, culpa earum harum expedita consectetur recusandae eum ratione tempora ullam a vitae quis.</div>
      </div>

      <div class="user2 shadow-sm  rounded">
      <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
      <hr/>
      <div>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Obcaecati voluptatibus doloremque sed a dolor veniam sapiente blanditiis quibusdam, nihil sequi.</div>
      </div>


      <div class="user1 shadow-sm  rounded">
        <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
        <hr/>
        <div  id="user">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia voluptatum corporis saepe beatae, rem vel est quaerat recusandae culpa dignissimos voluptates reiciendis hic nostrum deleniti minima eaque magnam, ipsa incidunt porro veritatis odio consequatur? Nemo, sequi necessitatibus, culpa earum harum expedita consectetur recusandae eum ratione tempora ullam a vitae quis.</div>
      </div>

      <div class="user2 shadow-sm   rounded">
      <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
      <hr/>
      <div>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Obcaecati voluptatibus doloremque sed a dolor veniam sapiente blanditiis quibusdam, nihil sequi.</div>
      </div>



      <div class="user1 shadow-sm  rounded">
        <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
        <hr/>
        <div  id="user">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia voluptatum corporis saepe beatae, rem vel est quaerat recusandae culpa dignissimos voluptates reiciendis hic nostrum deleniti minima eaque magnam, ipsa incidunt porro veritatis odio consequatur? Nemo, sequi necessitatibus, culpa earum harum expedita consectetur recusandae eum ratione tempora ullam a vitae quis.</div>
      </div>

      <div class="user2 shadow-sm   rounded">
      <div class="font-weight-bold">@username <span class="float-right"> 12:00AM </span></div>
      <hr/>
      <div>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Obcaecati voluptatibus doloremque sed a dolor veniam sapiente blanditiis quibusdam, nihil sequi.</div>
      </div>



    </div>
       


        <!-- Submit button-->
        <div class="btm" id="btm">
            <form id="form">
                <input id="input" placeholder="type your message here" autocomplete="off" type="text" required/>
                <input class="submit" type="submit" />
            </form>
        </div>







    </div>

</div>
    

<!-- <div class="main">
<div class="head"></div>
<div class="body"></div>
<div class="btn"></div>
</div>
 -->









{% endblock %}


{% block script %}

<script>

  // Chat Dialouge Box- Title appearance changing effects`
    var parentlist = document.querySelector('.list-group');
      parentlist.addEventListener('click',chatboxheader, false)

    function chatboxheader(event){
    
    if (event.target !== event.currentTarget) {
      
      let name = event.target.innerHTML
      document.querySelector('.head-h3').innerHTML = name
      
      //removing the body and its all childs
      document.querySelector('.body').remove()

      //creating another body tag
      var a = document.createElement('body')
      a.classList = 'body'
      var after = document.querySelector('.main')
      after.insertBefore(a,after.childNodes[2])
    }

    event.stopPropagation();        
    
    };



    //Displaying user name on the screen
    document.addEventListener('DOMContentLoaded',()=>{
        
      //setting up the sessinStorage for username
       let sessionUsername = `{{username}}`
       sessionStorage.setItem('username', sessionUsername) 





        // document.querySelector('#heading').innerHTML = 'Hi, {{username}}'
        updateSidebarList();

    });

    function updateSidebarList(){

      const array = JSON.parse(localStorage.getItem('channelList'))
        const ulist = document.querySelector('#ulist')
        array.forEach(element => {

            //creating element and storing it into variable
            let alink = document.createElement('a')          
            let div = document.createElement('div')
          
            //setting up properties
            alink.setAttribute('onclick','chatboxheader()')
            alink.setAttribute('href','#')

            // alink.onclick = "chatboxheader();"
            // alink.href    = "#"

            div.classList = "list-group-item  sidebar-list"
            div.innerHTML = "#" + element

            //appending
            alink.append(div)
            ulist.append(alink) 

        });


    };




    //New Channel storage system

    
    function createNewChannelFunction(){

      const list = JSON.parse(localStorage.getItem('channelList'))
      const newChannelName =  document.querySelector('#channel_name').value
      //    dict['channel']   = newChannelName

      //checking if the channel name already exists in the list or not
      if (list.find(element => element === newChannelName ) == undefined) {
        list.push(newChannelName)
      }
      else{
        document.querySelector('#channel_name').value = ''
        document.querySelector('.channelInvalidInput').innerHTML = 'Channel already exists.'
      }

      
     //updating localStorage 
     localStorage.setItem('channelList',JSON.stringify(list));

    //wiping the inputs
      document.querySelector('#channel_name').value = ''

    // Updating Sidebar
      updateSidebarList();
      
    };   

    
</script>

{% endblock %}